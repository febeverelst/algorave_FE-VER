---
const { title } = Astro.props;
const BASE = import.meta.env.BASE_URL || "/";
import "../styles/global.css";
import { recipes } from "../data/recipes";

type Recipe = (typeof recipes)[number];

const recipesByCourse = recipes.reduce<Record<string, Recipe[]>>(
    (acc, recipe) => {
        if (!acc[recipe.course]) acc[recipe.course] = [];
        acc[recipe.course].push(recipe);
        return acc;
    },
    {},
);
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />
        <title>The Cookbook: {title}</title>

        <link rel="stylesheet" href="/src/styles/global.css" />
    </head>

    <body>
        <header>
            <nav class="main-nav">
                <a href={BASE} class="nav-home">
                    <img
                        src={`${BASE}fe_verLogo.png`}
                        alt="Cookbook Home"
                        width="70"
                    />
                </a>

                <!-- Entrées -->
                <div class="nav-group">
                    <a href={`${BASE}entrees`}>Entrées</a>
                    <ul class="dropdown">
                        {
                            recipesByCourse["Entrées"]?.map((recipe) => (
                                <li>
                                    <a href={`${BASE}recipes/${recipe.slug}`}>
                                        {recipe.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </div>

                <!-- Palate Cleansers -->
                <div class="nav-group">
                    <a href={`${BASE}palate-cleansers`}>Palate Cleansers</a>
                    <ul class="dropdown">
                        {
                            recipesByCourse["Palate Cleansers"]?.map(
                                (recipe) => (
                                    <li>
                                        <a
                                            href={`${BASE}recipes/${recipe.slug}`}
                                        >
                                            {recipe.title}
                                        </a>
                                    </li>
                                ),
                            )
                        }
                    </ul>
                </div>

                <!-- Main Courses -->
                <div class="nav-group">
                    <a href={`${BASE}main-courses`}>Main Courses</a>
                    <ul class="dropdown">
                        {
                            recipesByCourse["Main Courses"]?.map((recipe) => (
                                <li>
                                    <a href={`${BASE}recipes/${recipe.slug}`}>
                                        {recipe.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </div>

                <!-- Sides -->
                <div class="nav-group">
                    <a href={`${BASE}sides`}>Sides</a>
                    <ul class="dropdown">
                        {
                            recipesByCourse["Sides"]?.map((recipe) => (
                                <li>
                                    <a href={`${BASE}recipes/${recipe.slug}`}>
                                        {recipe.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </div>

                <!-- Desserts -->
                <div class="nav-group">
                    <a href={`${BASE}desserts`}>Desserts</a>
                    <ul class="dropdown">
                        {
                            recipesByCourse["Desserts"]?.map((recipe) => (
                                <li>
                                    <a href={`${BASE}recipes/${recipe.slug}`}>
                                        {recipe.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </div>
            </nav>
            <hr />
        </header>

        <main>
            <slot />
        </main>
    </body>
</html>
